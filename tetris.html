<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tetris</title>
  <style>
    body {
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background-color: black;
    }
    canvas {
      background-color: darkgrey;
    }
  </style>
</head>
<body>
  <canvas id="tetris" width="300" height="600"></canvas>

  <script>
    const canvas = document.getElementById('tetris');
    const ctx = canvas.getContext('2d');
    const rows = 20;
    const columns = 10;
    const blockSize = 30;

    const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff', '#ff8000'];

    const tetrominos = [
      [[1, 1, 1, 1]], 
      [[1, 1, 1], [1]], 
      [[1, 1], [1, 1]], 
      [[1, 1, 0], [0, 1, 1]], 
      [[0, 1, 1], [1, 1, 0]], 
      [[1, 1, 0], [1, 0, 0]], 
      [[0, 0, 1], [1, 1, 1]]
    ];

    let board = Array.from({ length: rows }, () => Array(columns).fill(null));

    let currentTetromino, currentX, currentY;

    function startGame() {
      currentTetromino = generateTetromino();
      currentX = Math.floor(columns / 2) - Math.floor(currentTetromino[0].length / 2);
      currentY = 0;
      gameLoop();
    }

    function gameLoop() {
      if (isValidMove(0, 1)) {
        currentY++;
      } else {
        placeTetromino();
        currentTetromino = generateTetromino();
        currentX = Math.floor(columns / 2) - Math.floor(currentTetromino[0].length / 2);
        currentY = 0;
        if (!isValidMove(0, 0)) {
          return alert('Game Over!');
        }
      }
      clearCanvas();
      drawBoard();
      drawTetromino();
      requestAnimationFrame(gameLoop);
    }

    function generateTetromino() {
      const index = Math.floor(Math.random() * tetrominos.length);
      return tetrominos[index];
    }

    function isValidMove(dx, dy) {
      for (let row = 0; row < currentTetromino.length; row++) {
        for (let col = 0; col < currentTetromino[row].length; col++) {
          if (currentTetromino[row][col]) {
            const newX = currentX + col + dx;
            const newY = currentY + row + dy;
            if (newX < 0 || newX >= columns || newY >= rows || board[newY] && board[newY][newX]) {
              return false;
            }
          }
        }
      }
      return true;
    }

    function placeTetromino() {
      for (let row = 0; row < currentTetromino.length; row++) {
        for (let col = 0; col < currentTetromino[row].length; col++) {
          if (currentTetromino[row][col]) {
            board[currentY + row][currentX + col] = colors[colors.length - 1];
          }
        }
      }
    }

    function drawBoard() {
      for (let row = 0; row < rows; row++) {
        for (let col = 0; col < columns; col++) {
          const color = board[row][col];
          if (color) {
            ctx.fillStyle = color;
            ctx.fillRect(col * blockSize, row * blockSize, blockSize, blockSize);
          }
        }
      }
    }

    function drawTetromino() {
      for (let row = 0; row < currentTetromino.length; row++) {
        for (let col = 0; col < currentTetromino[row].length; col++) {
          if (currentTetromino[row][col]) {
            ctx.fillStyle = colors[colors.length - 1];
            ctx.fillRect((currentX + col) * blockSize, (currentY + row) * blockSize, blockSize, blockSize);
          }
        }
      }
    }

    function clearCanvas() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
    }

    startGame();
  </script>
</body>
</html>
